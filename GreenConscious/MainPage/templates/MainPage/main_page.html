{% extends 'base.html' %}

{% block title %}Your Dashboard{% endblock %}

{% load static %}

{% block extra_css %}
<link rel="stylesheet" type="text/css" href="{% static 'MainPage/style.css' %}">
<style>
  * {
    box-sizing: border-box;
  }

  .container {
    width: 100%;
  }

  .left {
    width: 25%;
    padding: 10px;
    background-color: #ffffff;
    vertical-align: top; /* Align content to the top */
    position: sticky !important;
    top: 0;
    height: fit-content; /* Ensure the column doesn't take the full height */
  }

  .right {
    width: 75%;
    padding: 10px;
    background-color: #ffffff;
    vertical-align: top; /* Align content to the top */
  }

  .left .search_button {
    width: 100%;
    display: block;
    margin-bottom: 10px; /* Space between buttons */
  }

  .no-events-message {
    text-align: center;
    margin-top: 20px;
    font-style: italic;
    color: #999;
  }
</style>
{% endblock %}

{% block navbar-content %}
    <a href="{% url 'MainPage:main_page' %}">
        <div class="name">Green Conscious</div>
    </a>
    <div class="login-register">
        <a href="{% url 'Login_SignUp:profile_view' %}">
            <button>My Profile</button>
        </a>
         <a href="{% url 'Login_SignUp:logoutPage' %}">
            <button>Log Out</button>
        </a>
    </div>
{%  endblock %}

{% block content %}
<div class="container">
  <table style="width: 100%; border-spacing: 20px;">
    <tr>
      <td class="left">
        <button onclick="location.href='{% url 'EventsPage:event_creation' %}'" class="search_button text-center">Create Event</button>
        <button onclick="location.href='{% url 'MainPage:main_page' %}'" class="search_button text-center">Upcoming Events</button>
        <button onclick="location.href='{% url 'MainPage:past_events' %}'" class="search_button text-center">Past Events</button>
      </td>

      <td class="right">
        <form method="get" action="{% url 'MainPage:main_page' %}" class="search-form">
          <input type="text" name="q" class="input_field"
                 value="{% if query %}{{ query }}{% endif %}" title="Please enter Event Name or Date Mon. DD, YYYY"
                 placeholder="Search to filter">
          <select name="category" class="input_field">
            <option value="">All Categories</option>
            {% for category in categories %}
              <option value="{{ category.id }}"
                      {% if selected_category == category.id %}
                          selected
                      {% endif %}>
                {{ category.name }}
              </option>
            {% endfor %}
          </select>
          <button class="search_button text-center" type="submit">Search</button>
        </form>

        {% if events %}
          {% for event in events %}
            <div class="event">
              <h2><a href="{% url 'MainPage:event_detail' event.id %}">{{ event.name }}</a></h2>
              <p><strong>Start Date:</strong> {{ event.start_date }}</p>
              <p><strong>End Date:</strong> {{ event.end_date }}</p>
              <p><strong>Description:</strong> {{ event.description }}</p>
              {% if event.image %}
                <img src="{{ event.image.url }}" alt="{{ event.name }}">
              {% endif %}
              <p><strong>Category:</strong> {{ event.category }}</p>
              <p><strong>Location:</strong> {{ event.location }}</p>
              <p><strong>Created By:</strong> {{ event.created_by.username }}</p>
            </div>
          {% endfor %}

          <!-- Pagination links -->
          <div class="pagination">
            <span class="step-links">
              {% if events.has_previous %}
                <a href="?page=1">&laquo; first</a>
                <a href="?page={{ events.previous_page_number }}">previous</a>
              {% endif %}

              <span class="current">
                Page {{ events.number }} of {{ events.paginator.num_pages }}.
              </span>

              {% if events.has_next %}
                <a href="?page={{ events.next_page_number }}">next</a>
                <a href="?page={{ events.paginator.num_pages }}">last &raquo;</a>
              {% endif %}
            </span>
          </div>
        {% else %}
          <p class="no-events-message">No events found.</p>
        {% endif %}
      </td>
    </tr>
  </table>
</div>
{% endblock %}
